/**
 * @author Josha Munnik
 * @copyright Copyright (c) 2022 Ultra Force Development
 * @license
 * MIT License
 *
 * Copyright (c) 2022 Josha Munnik
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
class t{constructor(){}static getOrFail(t,e){if(e in t)return t[e];throw new Error(`Missing ${e} in object`)}static getOrFailAs(e,n){return t.getOrFail(e,n)}static get(t,e,n){return e in t?t[e]:n}static getAs(t,e,n){return e in t?t[e]:n}static set(t,e,n){e in t&&(t[e]=n)}static setOrFail(t,e,n){if(!(e in t))throw new Error(`Missing ${e} in object`);t[e]=n}static getAttachedAs(t,e,n){return e in t||(t[e]=n()),t[e]}static equalProperties(e,n,o=!1){for(let a in n)if(n.hasOwnProperty(a)){if(!e.hasOwnProperty(a))return!1;switch(typeof n[a]){case"object":if(!t.equalProperties(e[a],n[a],o))return!1;break;case"string":let r=e[a],s=n[a];if(o&&(r=r.toLowerCase(),s=s.toLowerCase()),r!==s)return!1;break;default:if(e[a]!==n[a])return!1}}return!0}static backupProperties(e,n){const o=Array.isArray(e)?[]:{};for(const a in n)if(n.hasOwnProperty(a)&&e.hasOwnProperty(a)){let r=n[a];o[a]="object"==typeof r?t.backupProperties(e[a],n[a]):e[a]}return o}static applyProperties(e,n){for(const o in n)if(n.hasOwnProperty(o)&&e.hasOwnProperty(o)){const a=n[o];"function"==typeof a?a(e,o):"object"==typeof a?t.applyProperties(e[o],n[o]):e[o]=n[o]}return e}static deepCopy(t){const e={};return Object.keys(t).forEach(n=>{const o=t[n];e[n]="object"==typeof o?this.deepCopy(o):o}),e}static contains(t,...e){return e.findIndex(e=>t.hasOwnProperty(e))>=0}static combineObjects(e,n=!0,o="__init"){if(0===e.length)return{};const a={},r=[];return e.forEach(e=>t.copyProperties(e,a,o,r)),r.length&&t.callMethods(a,r,n?void 0:o),a}static copyProperty(t,e,n){const o=Object.getOwnPropertyDescriptor(e,t);o&&(o.get||o.set)?Object.defineProperty(n,t,o):n[t]=e[t]}static copyProperties(e,n,o,a){if(o&&!a)throw new Error("Missing separator list while a separator name was specified");Object.getOwnPropertyNames(e).forEach(r=>{o&&r===o?a.push(e[r]):t.copyProperty(r,e,n)})}static callMethods(t,e,n){const o=()=>e.forEach(e=>e.call(t));n?t[n]=o:o()}static instanceOf(t,e){if("function"!=typeof e)return!1;try{return t instanceof e}catch{return!1}}}
/**
 * @author Josha Munnik
 * @copyright Copyright (c) 2022 Ultra Force Development
 * @license
 * MIT License
 *
 * Copyright (c) 2022 Josha Munnik
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var e,n;!function(t){t[t.degrees=0]="degrees",t[t.radians=1]="radians"}(e||(e={}));class o{constructor(){}static get angleUnit(){return o.s_angleUnit}static set angleUnit(t){o.s_angleUnit=t}static toRadians(t){return o.angleUnit===e.degrees?t*Math.PI/180:t}static fromRadians(t){return o.angleUnit===e.degrees?180*t/Math.PI:t}static rotate(t,e,n,a=0,r=0){t=o.toRadians(t);const s=e-a,i=n-r,c=Math.sin(t),d=Math.cos(t);return{x:s*d-i*c+a,y:s*c+i*d+r}}static angle(t,e,n,a){return o.fromRadians(Math.atan2(a-e,n-t))}static distance(t,e,n,o){const a=t-n,r=e-o;return Math.sqrt(a*a+r*r)}static randomInteger(t,e){return void 0===e&&(e=t,t=0),Math.floor(t+Math.random()*(e-t+1))}static moveTo(t,e,n){return t>e?Math.min(t,e+n):Math.max(t,e-n)}static moveOverTime(t,e,n,o){return e+(t-e)*Math.max(0,Math.min(n,o))/o}static minmax(t,e,n){return Math.max(t,Math.min(e,n))}static isOverlapping(t,e,n,o,a,r,s,i){return!(t>=a+s||a>=t+n||e>=r+i||r>=e+o)}static isNumeric(t){return!Array.isArray(t)&&t-parseFloat(t)+1>=0}static getNumber(t,e){return this.isNumeric(t)?t:e}static xor(t,e){return!(!t&&!e||t&&e)}}o.s_angleUnit=e.degrees;
/**
 * @author Josha Munnik
 * @copyright Copyright (c) 2022 Ultra Force Development
 * @license
 * MIT License
 *
 * Copyright (c) 2022 Josha Munnik
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
class a{constructor(){}static append(t,e,n){return t.length<=0?e:e.length<=0?t:t+n+e}static escapeHtml(t){return t.replace(/[&<>"'\n\t\r]/g,t=>this.s_escapeHtmlMap.get(t))}static escapeRegExp(t){return String(t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}static generateCode(t){let e="",n=1;for(let a=0;a<t;a++){let t;for(;t=n>2?o.randomInteger(0,9):o.randomInteger(0,61),0===t||24===t||1===t||47===t;);t<10?(e+=String.fromCharCode(t+48),n=0):t<36?(e+=String.fromCharCode(t+65-10),n++):(e+=String.fromCharCode(t+97-10-26),n++)}return e}static twoDigits(t){return t<10?"0"+t:t.toString()}static threeDigits(t){return("000"+t.toString()).substring(-3)}static replace(t,e){for(const[n,o]of Object.entries(e))t=t.replace(n,o);return t}static hexTwoDigits(t){return("0"+Math.min(255,Math.max(0,t)).toString(16)).substring(-2)}static hexFourDigits(t){return("000"+Math.min(65535,Math.max(0,t)).toString(16)).substring(-4)}static join(t,...e){return e.reduce((e,n)=>(n.startsWith(t)&&(n=n.substring(t.length)),!e.endsWith(t)&&e.length&&(e+=t),e+n))}static joinPath(...t){return this.join("/",...t)}static getOrdinalPost(t){switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}static getOrdinalNumber(t){return t.toString()+this.getOrdinalPost(t)}static asString(t,e=""){switch(t){case null:case void 0:case NaN:return e;default:return t.toString()}}static formatFileSize(t){let e;return e=t<1024?t+" bytes":t<1048576?(t/1024).toFixed(1)+" KB":t<1073741824?(t/1024/1024).toFixed(1)+" MB":(t/1024/1024/1024).toFixed(1)+" GB",e}static getFileExtension(t){const e=t.lastIndexOf("/");e>0&&(t=t.substring(e+1));const n=t.lastIndexOf(".");return!(n<0)&&t.substring(n+1).toLowerCase()}static lpad(t,e,n=" "){for(;t.length<e;)t=n+t;return t}static rpad(t,e,n=" "){for(;t.length<e;)t+=n;return t}static addParameter(t,e,n){return n&&(e=e+"="+n),e=(t.indexOf("?")>=0?"&":"?")+e,t+e}static sprintf(t,...e){const n=new RegExp("%(?!%)((?<param_index>\\d+)\\$)?(\\{(?<prop_typed>\\w+)\\})?(?<add_plus>\\+)?(?<pad_zero>0|'(?<pad_char>.))?(?<left_justify>\\-)?(?<min_size>\\d+)?(\\.(?<max_size>\\d+))?(?<format_type>\\((?<prop_text>\\w+)\\)|[bcdefFousxX])","g");let o="",r=0,s=0,i=null;for(let c=n.exec(t);null!=c;c=n.exec(t)){if(!c.groups)continue;o+=t.substring(r,c.index),r=c.index+c[0].length;let n=null;const d=c.groups.prop_text?c.groups.prop_text:c.groups.prop_typed?c.groups.prop_typed:"";let l,u=null;if(c.groups.param_index){const t=Number(c.groups.param_index);if(t>=e.length){o+="%",r=c.index+1;continue}n=e[t],u=n}else if(0===d.length||null==i){if(s>=e.length){o+="%",r=c.index+1;continue}n=e[s++]}d.length>0&&(null==u&&(null==i&&(i=n),u=i),n=u[d]),c.groups.prop_text&&(c.groups.format_type="s");let h=c.groups.min_size?Number(c.groups.min_size):-1,m=c.groups.max_size?Number(c.groups.max_size):-1;switch(c.groups.format_type){case"s":switch(n){case null:l="null";break;case void 0:l="undefined";break;default:l=n.toString()}break;case"c":l=String.fromCharCode(Number(n));break;case"b":l=Number(n).toString(2);break;case"x":l=Number(n).toString(16).toLowerCase();break;case"X":l=Number(n).toString(16).toUpperCase();break;case"u":l=Number(n).toString();break;case"d":const t=Math.floor(Number(n));l=(t>=0&&c.groups.add_plus?c.groups.add_plus:"")+t.toString();break;case"o":l=Number(n).toString(8);break;case"e":case"f":case"F":const e=Number(n);l=e>=0&&c.groups.add_plus?c.groups.add_plus:"",m<0&&(m=6),l+="e"===c.groups.format_type?e.toExponential(m):e.toFixed(m),m=-1;break;default:throw new Error('Unknown format specifier "'+c.groups.format_type+'"')}if(h>=0){const t=c.groups.pad_char?c.groups.pad_char:c.groups.pad_zero?"0":" ";l=c.groups.left_justify?a.rpad(l,h,t):a.lpad(l,h,t)}m>=0&&(l=l.substring(0,m)),o+=l}return o+=t.substring(r),o=o.replace(/%%/g,"%"),o}static printf(t,...e){console.log(a.sprintf.apply(null,arguments))}static parseCSV(t,e=","){const n=[];let o=[],a="",r=!1;for(let s=0;s<t.length;s++){const i=t[s],c=s<t.length-2?t[s+1]:"";'"'===i?r&&'"'===c?(a+='"',s++):r=!r:i!==e||r?"\n"!==i&&"\r"!==i||r?a+=i:("\r"===i&&"\n"===c&&s++,o.push(a),n.push(o),o=[],a=""):(o.push(a),a="")}return n}}a.s_escapeHtmlMap=new Map([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["\n","<br/>"],["\t",""],["\r",""]]),function(t){t[t.Factory=0]="Factory",t[t.Constructor=1]="Constructor",t[t.Static=2]="Static",t[t.SingletonFactory=3]="SingletonFactory",t[t.SingletonConstructor=4]="SingletonConstructor"}(n||(n={}));class r{static async loadCSV(t){const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load CSV: ${e.status}`);const n=await e.text();return a.parseCSV(n)}static daysBetween(t,e){const n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return Math.abs(Math.floor((o-n)/864e5))}static hasSpeechRecognitionSupport(){return"SpeechRecognition"in window||"webkitSpeechRecognition"in window}}class s{static normalizeName(t){return t.trim().toLowerCase()}static normalizeForComparison(t){return t.trim().toLowerCase().replaceAll(" ","")}static suffixWithOrdinal(t){const e=["th","st","nd","rd"],n=t%100;return t+(e[(n-20)%10]||e[n]||e[0])}static formatDate(t){const e=s.suffixWithOrdinal(t.getDate());return`${t.toLocaleString("default",{month:"long"})} ${e}, ${t.getFullYear()}`}static formatDateWithTime(t){const e=s.suffixWithOrdinal(t.getDate());return`${t.toLocaleString("default",{month:"long"})} ${e}, ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}}class i{m_name;m_category;m_synonyms;constructor(t){this.m_name=s.normalizeName(t[0]),this.m_category=s.normalizeName(t[1]),this.m_synonyms=(t.length>2?t[2]:"").split(/[^\p{L} ]+/u).map(t=>s.normalizeName(t)).filter(Boolean)}get name(){return this.m_name}get category(){return this.m_category}get synonyms(){return this.m_synonyms}}class c{m_normalized;m_original;m_food;constructor(t,e){this.m_original=s.normalizeName(t),this.m_normalized=s.normalizeForComparison(t),this.m_food=e}get normalized(){return this.m_normalized}get original(){return this.m_original}get food(){return this.m_food}}const d=new class{m_foodEntries=[];m_compareItemsByLength=[];m_compareItemsByOriginal=[];constructor(){}import(t){this.processRows(t),this.buildCompareItems(),this.sortCompareItems()}findForName(t){return this.m_foodEntries.find(e=>e.name===t)||null}getList(){return this.m_compareItemsByOriginal}processText(t){const e=[];let n=s.normalizeForComparison(t);return this.m_compareItemsByLength.forEach(t=>{n.includes(t.normalized)&&(e.push(t),n=n.replaceAll(t.normalized,""))}),e}processRows(t){this.m_foodEntries=[],t.forEach(t=>{if(t.length>1){const e=s.normalizeName(t[0]);this.hasFood(e)&&console.warn(`Duplicate food name "${e}" found, skipping row: ${t}`),this.m_foodEntries.push(new i(t))}else console.warn(`Skipping row with insufficient columns: ${t}`)}),console.debug(`Processed ${this.m_foodEntries.length} foods from ${t.length} rows`)}buildCompareItems(){this.m_compareItemsByLength=[],this.m_foodEntries.forEach(t=>this.addFoodToCompareItems(t)),this.m_compareItemsByOriginal=[...this.m_compareItemsByLength]}addFoodToCompareItems(t){this.m_compareItemsByLength.push(new c(t.name,t)),t.synonyms.forEach(e=>this.m_compareItemsByLength.push(new c(e,t)))}hasFood(t){return this.m_foodEntries.some(e=>e.name===t)}sortCompareItems(){this.m_compareItemsByLength.sort((t,e)=>e.normalized.length-t.normalized.length),this.m_compareItemsByOriginal.sort((t,e)=>t.original.localeCompare(e.original))}};class l{m_food;m_consumedName;m_date;static createFromInput(t){return new l(t.food,t.original,new Date)}static createFromStorage(t){const e=JSON.parse(t),n=d.findForName(e.foodName);if(null==n)throw new Error(`Food with name "${e.foodName}" not found in food data.`);return new l(n,e.consumedName,new Date(e.date))}toJson(){const t={foodName:this.m_food.name,consumedName:this.m_consumedName,date:this.m_date.toISOString()};return JSON.stringify(t)}get food(){return this.m_food}get consumedName(){return this.m_consumedName}get date(){return this.m_date}constructor(t,e,n){this.m_consumedName=e,this.m_date=n,this.m_food=t}}class u{m_startDate;m_endDate;m_foods;constructor(t,e,n){this.m_startDate=t,this.m_endDate=e,this.m_foods=[...n],this.m_foods.sort((t,e)=>t.name.localeCompare(e.name))}get startDate(){return this.m_startDate}get endDate(){return this.m_endDate}get foods(){return this.m_foods}}const h="startDayOfWeek";const m=new class{m_startDayOfWeek;constructor(){this.m_startDayOfWeek=parseInt(localStorage.getItem(h)||"0")}get startDayOfWeek(){return this.m_startDayOfWeek}set startDayOfWeek(t){this.m_startDayOfWeek=t,localStorage.setItem(h,t.toString())}},g="historyData";const p=new class{m_historyEntries=[];initialize(){this.m_historyEntries=this.loadFromStorage(),this.sortEntries()}add(t){t.forEach(t=>this.m_historyEntries.push(l.createFromInput(t))),this.sortEntries(),this.saveToStorage(this.m_historyEntries)}getCountForToday(){return this.getWeekEntryForDate(new Date)}getCountsPerWeek(){if(0===this.m_historyEntries.length)return[];const t=this.m_historyEntries.at(-1).date,e=[];for(let n=this.endOfWeek(new Date);n>=t;n.setDate(n.getDate()-7))e.push(this.getWeekEntryForDate(n));return e}getListForWeek(t){return this.m_historyEntries.filter(e=>e.date>=t.startDate&&e.date<=t.endDate)}clear(){this.m_historyEntries=[],this.saveToStorage(this.m_historyEntries)}loadFromStorage(){const t=localStorage.getItem(g);if(!t)return[];return JSON.parse(t).map(t=>l.createFromStorage(t))}saveToStorage(t){const e=t.map(t=>t.toJson());localStorage.setItem(g,JSON.stringify(e))}sortEntries(){this.m_historyEntries.sort((t,e)=>e.date.getTime()-t.date.getTime())}startOfWeek(t){const e=new Date(t),n=m.startDayOfWeek,o=(e.getDay()-n+7)%7,a=new Date(e);return a.setDate(e.getDate()-o),a.setHours(0,0,0,0),a}endOfWeek(t){const e=this.startOfWeek(t);return e.setDate(e.getDate()+6),e.setHours(23,59,59,999),e}getWeekEntryForDate(t){const e=this.startOfWeek(t),n=this.endOfWeek(e),o=new Set;return this.m_historyEntries.filter(t=>t.date>=e&&t.date<=n).forEach(t=>o.add(t.food)),new u(e,n,o)}},f="tp-page--is-hidden";class y{m_id;m_title;m_pageElement;constructor(t,e){this.m_id=t,this.m_title=e,this.m_pageElement=document.getElementById(t)}getPreviousPage(){return null}show(){this.onShowStart(),this.m_pageElement.classList.remove(f),document.title=`20 foods | ${this.m_title}`,this.onShowDone()}hide(){this.onHideStart(),this.m_pageElement.classList.add(f),this.onHideDone()}scrollToTop(){window.scrollTo(0,0)}onShowStart(){}onShowDone(){}onHideStart(){}onHideDone(){}}const _=new class extends y{constructor(){super("loading-page","loading")}},w="ufDisplayBackup";
/**
 * @author Josha Munnik
 * @copyright Copyright (c) 2024 Ultra Force Development
 * @license
 * MIT License
 *
 * Copyright (c) 2024 Josha Munnik
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */class E{constructor(){}static escapeHtml(t){return t.replace(/[&<>"'\n\t\r]/g,t=>this.s_escapeHtmlMap.get(t))}static convertToPlain(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}static addClasses(t,e){t&&e&&e.split(" ").forEach(e=>t.classList.add(e.trim()))}static removeClasses(t,e){t&&e&&e.split(" ").forEach(e=>t.classList.remove(e.trim()))}static toggleClasses(t,e,n){t&&e&&e.split(" ").forEach(e=>t.classList.toggle(e.trim(),n))}static addAndRemoveClasses(t,e,n){this.addClasses(t,e),this.removeClasses(t,n)}static addListener(t,e,n){const o="string"==typeof t?document.querySelector(t):t;if(null==o)return()=>{};const a=e.split(" ").filter(t=>t.trim().length>0);return a.forEach(t=>o.addEventListener(t,n)),()=>{a.forEach(t=>o.removeEventListener(t,n))}}static addBodyListener(t,e,n){const o=e.split(" ").filter(t=>t.trim().length>0),a=e=>{if(null==e.target||!(e.target instanceof HTMLElement))return;const o=e.target.closest(t);if(!o)return;const a=n(o);a instanceof Function?a(e):"handleEvent"in a&&a.handleEvent(e)};return o.forEach(t=>document.body.addEventListener(t,a,!0)),()=>o.forEach(t=>document.body.removeEventListener(t,a,!0))}static addListeners(t,e,n){const o="string"==typeof t?document.querySelectorAll(t):t,a=[];return o.forEach(t=>a.push(E.addListener(t,e,n(t)))),()=>a.forEach(t=>t())}static getAttribute(t,e,n=""){return t.attributes.getNamedItem(e)?.value??n}static hasAttribute(t,e){return null!=t.attributes.getNamedItem(e)}static get(t,e){const n="string"==typeof t?(e||document).querySelector(t):t;if(null==n)throw new Error(`Can not find element for ${t}`);return n}static getForId(t){const e=document.getElementById(t);if(null==e)throw new Error(`Can not find element for ${t}`);return e}static fadeIn(t,e=400){t.style.opacity="0",t.style.transition=`opacity ${e}ms`,setTimeout(()=>t.style.opacity="1",0)}static fadeOut(t,e=400){t.style.opacity="1",t.style.transition=`opacity ${e}ms`,setTimeout(()=>t.style.opacity="0",0)}static createAs(t){const e=(new DOMParser).parseFromString(t,"text/html").body.firstChild;return e.remove(),e}static empty(t){for(;t.firstChild;)t.removeChild(t.firstChild)}static getFirstParent(t,e){for(let n=t.parentElement;n;n=n.parentElement)if(n.matches(e))return n;return null}static getParents(t,e){const n=[];for(let o=t.parentElement;o;o=o.parentElement)e&&!o.matches(e)||n.push(o);return n}static show(e,n){e.style.display=n??t.getAttachedAs(e,w,()=>"block")}static hide(e){t.getAttachedAs(e,w,()=>e.style.display),e.style.display="none"}static copyAttributes(t,e,n){const o=n||document;for(const n in e){const a=t.getAttribute(n);if(null===a)continue;const r=o.querySelectorAll(e[n]);r&&r.forEach(t=>{this.assignValue(t,a)||(t instanceof HTMLImageElement?t.src=a:t instanceof HTMLElement&&(t.innerText=a))})}}static getAttributeNames(t){const e=[];for(let n=0;n<t.attributes.length;n++){const o=t.attributes[n];e.push(o.name)}return e}static buildDataAttributesMap(t){const e={};for(let n=0;n<t.attributes.length;n++){const o=t.attributes[n].name;o.startsWith("data-uf-")||o.startsWith("data-")&&(e[o]=`[${o}]`)}return e}static reload(){window.history.replaceState&&window.history.replaceState(null,"",window.location.href),window.location.href=window.location.href}static assignValue(t,e){if(t instanceof HTMLInputElement)"checkbox"===t.type||"radio"===t.type?t.checked="true"===e||"1"===e||"checked"===e:(t.value=e,t.dispatchEvent(new InputEvent("input")));else if(t instanceof HTMLTextAreaElement)t.value=e,t.dispatchEvent(new InputEvent("input"));else{if(!(t instanceof HTMLSelectElement))return!1;t.value=e}return t.dispatchEvent(new Event("change")),!0}static isVisible(t,e=!0){const n=window.getComputedStyle(t);return"none"!==n.display&&"hidden"!==n.visibility&&"0"!==n.opacity&&((0!==t.offsetWidth||0!==t.offsetHeight)&&(!e||!t.parentElement||this.isVisible(t.parentElement)))}static getForAttribute(t,e=null,n){let o=t;null!==e&&(o+=`="${e}"`);const a=(n||document).querySelector(`[${o}]`);if(null==a)throw new Error(`Can not find element for attribute ${o}`);return a}static findForAttribute(t,e=null,n){let o=t;return null!==e&&(o+=`="${e}"`),(n||document).querySelector(`[${o}]`)}static findAllForAttribute(t,e=null,n){let o=t;return null!==e&&(o+=`="${e}"`),(n||document).querySelectorAll(`[${o}]`)}static insertAfter(t,e,n){n.nextElementSibling?t.insertBefore(e,n.nextElementSibling):t.appendChild(e)}}
/**
 * @author Josha Munnik
 * @copyright Copyright (c) 2022 Ultra Force Development
 * @license
 * MIT License
 *
 * Copyright (c) 2022 Josha Munnik
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var S,C,k,v,b,F,x,T,D,I,L,N,P,H,B,O,A,M,R,W,q,z,$,V,j,G,U,J,Y,K,X,Z,Q,tt,et,nt;E.s_escapeHtmlMap=new Map([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["\n","<br/>"],["\t",""],["\r",""]]),function(t){t.Showing="showing",t.Visible="visible",t.Hiding="hiding",t.Hidden="hidden"}(S||(S={})),(C||(C={})).floater="data-uf-floater",function(t){t.Adjacent="adjacent",t.Overlap="overlap",t.Relative="relative"}(k||(k={})),function(t){t.None="none",t.Show="show",t.Toggle="toggle"}(v||(v={})),function(t){t.None="none",t.Always="always",t.Tree="tree",t.Outside="outside"}(b||(b={})),function(t){t.None="none",t.Fade="fade",t.SlideVertical="slide-vertical",t.SlideHorizontal="slide-horizontal",t.Custom="custom"}(F||(F={})),E.createAs('<div style="position: fixed; top: 0; left: 0; pointer-events: none;"></div>'),function(t){t.dataOver="data-uf-over",t.dataDisabled="data-uf-disabled"}(x||(x={})),function(t){t.Idle="Idle",t.Preloading="Preloading",t.Preloaded="Preloaded",t.Loading="Loading",t.Playing="Playing",t.Stopped="Stopped"}(T||(T={})),function(t){t.DisplayValue="data-uf-display-value",t.ShowClasses="data-uf-show-classes",t.HideClasses="data-uf-hide-classes"}(D||(D={})),function(t){t.Self="_self",t.Parent="_parent",t.Next="_next",t.Previous="_previous",t.Grandparent="_grandparent",t.Dialog="_dialog"}(I||(I={})),function(t){t.NoFilter="data-uf-no-filter",t.FilterTable="data-uf-filter-table",t.HeaderRow="data-uf-header-row",t.RowNoMatch="data-uf-row-no-match"}(L||(L={})),function(t){t.ClickStylingSelector="data-uf-click-styling-selector",t.ClickStylingClasses="data-uf-click-styling-classes"}(N||(N={})),function(t){t.DetailsCollapse="data-uf-details-collapse",t.DetailsExpand="data-uf-details-expand"}(P||(P={})),(H||(H={})).ShowDialog="data-uf-show-dialog",function(t){t.EventAction="data-uf-event-action",t.EventEvents="data-uf-event-events",t.EventTarget="data-uf-event-target",t.EventData="data-uf-event-data",t.EventAttribute="data-uf-event-attribute",t.EventState="data-uf-event-state",t.EventKey="data-uf-event-key",t.EventPreventDefault="data-uf-event-prevent-default",t.ClickAction="data-uf-click-action",t.ClickTarget="data-uf-click-target",t.ClickData="data-uf-click-data",t.ClickAttribute="data-uf-click-attribute",t.LoadAction="data-uf-load-action",t.LoadTarget="data-uf-load-target",t.LoadData="data-uf-load-data",t.LoadAttribute="data-uf-load-attribute"}(B||(B={})),function(t){t.RemoveFromDom="remove-from-dom",t.Hide="hide",t.Show="show",t.Toggle="toggle",t.ToggleClass="toggle-class",t.RemoveFromClass="remove-from-class",t.AddToClass="add-to-class",t.ShowModal="show-modal",t.ShowNonModal="show-non-modal",t.Close="close",t.SetAttribute="set-attribute",t.Reload="reload",t.SetValue="set-value",t.SetText="set-text",t.SetHtml="set-html"}(O||(O={})),function(t){t.ImagePreview="data-uf-image-preview",t.FileName="data-uf-file-name",t.ImageWidth="data-uf-image-width",t.ImageHeight="data-uf-image-height",t.FileSize="data-uf-file-size",t.FileType="data-uf-file-type",t.FileNone="data-uf-file-none",t.FileShow="data-uf-file-show"}(A||(A={})),function(t){t.NoFilter="data-uf-no-filter",t.FilterInput="data-uf-filter-input",t.NoMatch="data-uf-filter-no-match",t.Group="data-uf-filter-group",t.Container="data-uf-filter-container"}(M||(M={})),function(t){t.Type="data-uf-toggle-type",t.Property="data-uf-toggle-property",t.Selector="data-uf-toggle-selector",t.Change="data-uf-toggle-change",t.Classes="data-uf-toggle-classes",t.ClassesMatch="data-uf-toggle-classes-match",t.Condition="data-uf-toggle-condition",t.Value="data-uf-toggle-value",t.Values="data-uf-toggle-values",t.ValuesSeparator="data-uf-toggle-values-separator",t.Required="data-uf-toggle-required",t.Target="data-uf-toggle-target",t.Compare="data-uf-toggle-compare"}(R||(R={})),function(t){t[t.Auto=0]="Auto",t[t.Value=1]="Value",t[t.Valid=2]="Valid",t[t.Property=3]="Property"}(W||(W={})),function(t){t[t.Auto=0]="Auto",t[t.None=1]="None",t[t.Enable=2]="Enable",t[t.Visible=3]="Visible",t[t.Required=4]="Required",t[t.NotRequired=5]="NotRequired"}(q||(q={})),function(t){t[t.Any=0]="Any",t[t.All=1]="All",t[t.None=2]="None"}(z||(z={})),function(t){t[t.None=0]="None",t[t.Match=1]="Match",t[t.NoMatch=2]="NoMatch"}($||($={})),function(t){t[t.Equal=0]="Equal",t[t.Contain=1]="Contain",t[t.Inside=2]="Inside",t[t.LessThan=3]="LessThan",t[t.LessThanOrEqual=4]="LessThanOrEqual",t[t.GreaterThan=5]="GreaterThan",t[t.GreaterThanOrEqual=6]="GreaterThanOrEqual"}(V||(V={})),R.Type,R.Selector,R.Change,R.Classes,R.ClassesMatch,R.Condition,R.Compare,function(t){t.Sorting="data-uf-grid-sorting",t.SortControl="data-uf-sort-control",t.SortButton="data-uf-sort-button",t.SortKey="data-uf-sort-key",t.GroupSize="data-uf-group-size",t.ItemContainer="data-uf-item-container",t.ItemGroup="data-uf-item-group",t.SortValue="data-uf-sort-value",t.SortAscending="data-uf-sort-ascending",t.SortDescending="data-uf-sort-descending",t.StorageId="data-uf-storage-id",t.GridBody="data-uf-grid-body"}(j||(j={})),function(t){t[t.None=0]="None",t[t.Number=1]="Number",t[t.Text=2]="Text",t[t.Date=3]="Date"}(G||(G={})),j.ItemContainer,j.ItemGroup,j.SortControl,function(t){t.PopupContent="data-uf-popup-content",t.PopupPosition="data-uf-popup-position",t.PopupHide="data-uf-popup-hide",t.PopupTransition="data-uf-popup-transition",t.PopupDeltaX="data-uf-popup-delta-x",t.PopupDeltaY="data-uf-popup-delta-y"}(U||(U={})),function(t){t.Vertical="vertical",t.Horizontal="horizontal",t.Overlap="overlap"}(J||(J={})),function(t){t.Tree="tree",t.Always="always"}(Y||(Y={})),(K||(K={})).SelectUrl="data-uf-select-url",(X||(X={})).ShareHover="data-uf-share-hover",(Z||(Z={})).PageRefresh="data-uf-page-refresh",(Q||(Q={})).ManageSubmit="data-uf-manage-submit",function(t){t[t.Contain=0]="Contain",t[t.Cover=1]="Cover",t[t.Stretch=2]="Stretch"}(tt||(tt={})),function(t){t.Png="image/png",t.Jpeg="image/jpeg"}(et||(et={})),function(t){t.Get="GET",t.Post="POST",t.Put="PUT",t.Patch="PATCH",t.Delete="DELETE"}(nt||(nt={}));const ot=new class{m_selectedWeek=null;m_compareEntries=[];removeCompareEntry(t){const e=this.m_compareEntries.indexOf(t);e>-1&&this.m_compareEntries.splice(e,1)}get selectedWeek(){return this.m_selectedWeek}set selectedWeek(t){this.m_selectedWeek=t}get compareEntries(){return this.m_compareEntries}set compareEntries(t){this.m_compareEntries=t}};var at;!function(t){t.Hidden="tp-hidden",t.TextSuccess="tp-text--is-success"}(at||(at={}));const rt=new class extends y{m_foodCount=E.getForId("food-count");m_dayCount=E.getForId("day-count");m_weekStart=E.getForId("week-start");m_today=E.getForId("today");m_settingsButton=E.getForId("settings-button");m_historyButton=E.getForId("history-button");m_dictateButton=E.getForId("dictate-button");m_manualButton=E.getForId("manual-button");m_missingSpeechRecognition=E.getForId("missing-speech-recognition");constructor(){super("home-page","home"),this.m_settingsButton.addEventListener("click",()=>this.handleSettingsButtonClick()),this.m_historyButton.addEventListener("click",()=>this.handleHistoryButtonClick()),this.m_manualButton.addEventListener("click",()=>this.handleManualButtonClick()),r.hasSpeechRecognitionSupport()?(this.m_missingSpeechRecognition.classList.add(at.Hidden),this.m_dictateButton.addEventListener("click",()=>this.handleDictateButtonClick())):(this.m_dictateButton.disabled=!0,this.m_dictateButton.classList.add(at.Hidden))}onShowStart(){const t=p.getCountForToday();this.m_weekStart.innerText=s.formatDate(t.startDate),this.m_today.innerText=s.formatDate(new Date),this.m_dayCount.innerText=(7-r.daysBetween(t.startDate,new Date)).toString(),this.m_foodCount.innerText=t.foods.length.toString(),this.m_foodCount.classList.toggle(at.TextSuccess,t.foods.length>=20)}handleSettingsButtonClick(){pt.showSettings()}handleHistoryButtonClick(){pt.showHistory()}handleDictateButtonClick(){pt.showDictation()}handleManualButtonClick(){ot.compareEntries=[],pt.showConfirm()}};var st;!function(t){t.BackButton="[data-tp-back-button]",t.OriginalName="[data-tp-original-name]",t.FoodName="[data-tp-food-name]",t.CategoryName="[data-tp-category-name]",t.AddButton="[data-tp-add-button]",t.RemoveButton="[data-tp-remove-button]",t.FoodCount="[data-tp-food-count]",t.StartDate="[data-tp-start-date]",t.EndDate="[data-tp-end-date]",t.ViewButton="[data-tp-view-button]",t.ExpandButton="[data-tp-expand-button]",t.CollapseButton="[data-tp-collapse-button]",t.FoodHistoryEntries="[data-tp-food-history-entries]",t.FoodHistoryDate="[data-tp-food-history-date]",t.FoodHistoryName="[data-tp-food-history-name]"}(st||(st={}));const it=new class extends y{m_weekStart=E.getForId("week-start-title");m_weekEnd=E.getForId("week-end-title");m_foodEntries=E.getForId("food-entries");m_foodEntryTemplate=E.getForId("food-entry");m_foodHistoryEntryTemplate=E.getForId("food-history-entry");constructor(){super("week-page","week overview")}onShowStart(){this.m_foodEntries.replaceChildren();const t=ot.selectedWeek;this.m_weekStart.innerText=s.formatDate(t.startDate),this.m_weekEnd.innerText=s.formatDate(t.endDate);const e=p.getListForWeek(t);this.getFoods(e).forEach(t=>this.m_foodEntries.appendChild(this.createFoodEntryElement(t,this.getHistoryEntriesForFood(t,e))))}onHideDone(){this.m_foodEntries.replaceChildren()}getFoods(t){const e=new Set;t.forEach(t=>e.add(t.food));const n=[...e];return n.sort((t,e)=>t.name.localeCompare(e.name)),n}getHistoryEntriesForFood(t,e){const n=e.filter(e=>e.food===t);return n.sort((t,e)=>t.date.getTime()-e.date.getTime()),n}createFoodEntryElement(t,e){const n=this.m_foodEntryTemplate.content.cloneNode(!0),o=n.querySelector(st.FoodName),a=n.querySelector(st.CategoryName),r=n.querySelector(st.FoodHistoryEntries),s=n.querySelector(st.CollapseButton),i=n.querySelector(st.ExpandButton);return o.innerText=t.name,a.innerText=t.category,e.forEach(t=>r.appendChild(this.createFoodHistoryEntryElement(t))),s.classList.add(at.Hidden),r.classList.add(at.Hidden),s.addEventListener("click",()=>this.handleCollapseClick(r,s,i)),i.addEventListener("click",()=>this.handleExpandClick(r,s,i)),n}createFoodHistoryEntryElement(t){const e=this.m_foodHistoryEntryTemplate.content.cloneNode(!0),n=e.querySelector(st.FoodHistoryDate),o=e.querySelector(st.FoodHistoryName);return n.innerText=s.formatDateWithTime(t.date),o.innerText=t.consumedName,e}handleCollapseClick(t,e,n){t.classList.add(at.Hidden),e.classList.add(at.Hidden),n.classList.remove(at.Hidden)}handleExpandClick(t,e,n){t.classList.remove(at.Hidden),e.classList.remove(at.Hidden),n.classList.add(at.Hidden)}};const ct=new class extends y{m_weekStartSelect=E.getForId("week-start-select");m_clearHistoryButton=E.getForId("clear-history-button");constructor(){super("settings-page","settings"),this.m_weekStartSelect.addEventListener("change",()=>this.handleWeekStartChange()),this.m_clearHistoryButton.addEventListener("click",()=>this.handleClearHistory())}onShowStart(){this.m_weekStartSelect.value=String(m.startDayOfWeek)}handleWeekStartChange(){const t=parseInt(this.m_weekStartSelect.value,10);!isNaN(t)&&t>=0&&t<=6&&(m.startDayOfWeek=t)}handleClearHistory(){confirm("Are you sure you want to clear your history? This action cannot be undone.")&&p.clear()}};const dt=new class extends y{m_entries=E.getForId("history-entries");m_entryTemplate=E.getForId("history-entry");constructor(){super("history-page","history")}onShowStart(){this.m_entries.replaceChildren();p.getCountsPerWeek().forEach(t=>this.m_entries.appendChild(this.createEntryElement(t)))}onHideDone(){this.m_entries.replaceChildren()}createEntryElement(t){const e=this.m_entryTemplate.content.cloneNode(!0),n=e.querySelector(st.StartDate),o=e.querySelector(st.EndDate),a=e.querySelector(st.FoodCount),r=e.querySelector(st.ViewButton);n.innerText=s.formatDate(t.startDate),o.innerText=s.formatDate(t.endDate);const i=t.foods.length;return a.innerText=i.toString(),i>=20&&a.classList.add(at.TextSuccess),r.addEventListener("click",()=>this.handleViewClick(t)),e}handleViewClick(t){pt.showWeek(t)}},lt=["stop","done","finish"];const ut=new class extends y{m_status=E.getForId("dictation-status");m_pauseButton=E.getForId("dictation-pause-button");m_recordButton=E.getForId("dictation-record-button");m_stopButton=E.getForId("dictation-stop-button");m_recordedText=E.getForId("dictation-recorded-text");m_recognition=null;m_active=!1;constructor(){if(super("dictation-page","dictate entries"),r.hasSpeechRecognitionSupport()){const t=window.SpeechRecognition||window.webkitSpeechRecognition;this.m_recognition=new t,this.m_recognition.lang="en-US",this.m_recognition.continuous=!0,this.m_recognition.interimResults=!0,this.m_recognition.maxAlternatives=1,this.m_recognition.addEventListener("result",t=>this.handleRecognitionResult(t)),this.m_recognition.addEventListener("error",t=>this.handleRecognitionError(t)),this.m_recognition.addEventListener("end",()=>this.handleRecognitionEnd())}this.m_recordButton.addEventListener("click",()=>this.handleRecordClick()),this.m_pauseButton.addEventListener("click",()=>this.handlePauseClick()),this.m_stopButton.addEventListener("click",()=>this.handleStopClick())}onShowStart(){this.m_active=!0,this.m_recordedText.innerText="",this.showPause(),this.startRecording()}onHideDone(){}showPause(){this.m_pauseButton.classList.remove(at.Hidden),this.m_recordButton.classList.add(at.Hidden),this.m_status.innerText="Recording"}showRecord(){this.m_pauseButton.classList.add(at.Hidden),this.m_recordButton.classList.remove(at.Hidden),this.m_status.innerText="Paused"}startRecording(){try{this.m_recognition.start()}catch(t){console.warn(t)}}stop(){this.m_active&&(this.m_active=!1,this.m_recognition.stop(),this.processTranscript(),pt.showConfirm())}processTranscript(){ot.compareEntries=d.processText(this.m_recordedText.innerText)}containsStopCommand(t){const e=s.normalizeForComparison(t);return lt.some(t=>e.includes(t))}handleRecognitionResult(t){for(let e=t.resultIndex;e<t.results.length;e++){const n=t.results[e][0].transcript;t.results[e].isFinal&&(this.m_recordedText.innerText+=n+" ")}this.containsStopCommand(this.m_recordedText.innerText)&&this.stop()}handleRecognitionError(t){console.error("Recognition Error:",t),this.showRecord()}handleRecognitionEnd(){this.showRecord()}handleRecordClick(){this.m_recognition.start(),this.showPause()}handlePauseClick(){this.m_recognition.stop(),this.showRecord()}handleStopClick(){this.stop()}};const ht=new class extends y{m_confirmEntries=E.getForId("confirm-entries");m_entryTemplate=E.getForId("confirm-entry-template");m_saveButton=E.getForId("confirm-save-button");m_addButton=E.getForId("confirm-add-button");m_none=E.getForId("confirm-none");constructor(){super("confirm-page","confirm entries"),this.m_saveButton.addEventListener("click",()=>this.handleSaveClick()),this.m_addButton.addEventListener("click",()=>this.handleAddClick())}onShowStart(){this.buildList(),this.updateVisibility()}onHideDone(){this.m_confirmEntries.replaceChildren()}buildList(){const t=ot.compareEntries;this.m_confirmEntries.replaceChildren(),t.forEach(t=>this.m_confirmEntries.appendChild(this.createEntryElement(t)))}updateVisibility(){const t=ot.compareEntries.length>0;this.m_none.classList.toggle(at.Hidden,t),this.m_confirmEntries.classList.toggle(at.Hidden,!t),this.m_saveButton.disabled=!t}createEntryElement(t){const e=this.m_entryTemplate.content.cloneNode(!0),n=e.querySelector(st.OriginalName),o=e.querySelector(st.FoodName),a=e.querySelector(st.RemoveButton);return n.innerText=t.original,o.innerText=t.food.name,a.addEventListener("click",()=>this.handleRemoveClick(t)),e}handleRemoveClick(t){ot.removeCompareEntry(t),this.buildList(),this.updateVisibility()}handleSaveClick(){p.add(ot.compareEntries),ot.compareEntries=[],pt.back()}handleAddClick(){pt.showAdd()}},mt="data-tp-filter-text";const gt=new class extends y{m_filterInput=E.getForId("add-filter-input");m_addEntries=E.getForId("add-entries");m_entryTemplate=E.getForId("add-entry-template");m_children=[];constructor(){super("add-page","add entry"),this.m_filterInput.addEventListener("input",()=>this.handleFilterChange())}onShowStart(){const t=d.getList();this.m_addEntries.replaceChildren(),this.m_filterInput.value="",t.forEach(t=>this.m_addEntries.appendChild(this.createEntryElement(t))),this.m_children=Array.from(this.m_addEntries.children)}onHideDone(){this.m_children=[],this.m_addEntries.replaceChildren()}createEntryElement(t){const e=this.m_entryTemplate.content.cloneNode(!0),n=s.normalizeForComparison(`${t.original}${t.food.name}`),o=e.querySelector(st.OriginalName),a=e.querySelector(st.FoodName),r=e.querySelector(st.AddButton);return o.innerText=t.original,a.innerText=t.food.name,r.addEventListener("click",()=>this.handleAddClick(t)),o.setAttribute(mt,n),a.setAttribute(mt,n),r.setAttribute(mt,n),e}handleAddClick(t){ot.compareEntries.push(t),pt.back()}handleFilterChange(){const t=s.normalizeForComparison(this.m_filterInput.value);this.m_children.forEach(e=>{const n=e.getAttribute(mt)??"";e.classList.toggle(at.Hidden,!n.includes(t))})}};const pt=new class{m_pageStack=[];start(){_.hide(),this.showPage(rt)}back(){const t=this.m_pageStack.pop();t&&t.hide(),this.m_pageStack.length>0&&this.m_pageStack.at(-1).show()}showAdd(){this.showPage(gt)}showConfirm(){this.showPage(ht,this.m_pageStack.at(-1)===ut)}showDictation(){this.showPage(ut)}showHistory(){this.showPage(dt)}showSettings(){this.showPage(ct)}showWeek(t){ot.selectedWeek=t,this.showPage(it)}showPage(t,e=!1){this.m_pageStack.length>0&&this.m_pageStack.at(-1).hide(),e&&this.m_pageStack.pop(),this.m_pageStack.push(t),t.show()}};const ft=new class{async run(){const t=await r.loadCSV("https://docs.google.com/spreadsheets/d/e/2PACX-1vQwlU_Al-u5JKhCjje6GZCNxdafpKBsZw2luPFZC8Vl6xd7eaNMjtJ3hxdrO8TGoYSS1In8WqEM3BEY/pub?output=csv");d.import(t),p.initialize(),E.addListeners(st.BackButton,"click",()=>()=>pt.back()),pt.start()}};await ft.run();
